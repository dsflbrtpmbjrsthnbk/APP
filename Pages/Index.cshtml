@page
@model IndexModel
@{
    ViewData["Title"] = "Music Library";
}

<div class="container mt-4">
    <h1 class="text-center mb-4">Music Library</h1>
    <p class="text-center text-muted mb-4">Seeded random music showcase</p>

    <div class="row g-3 mb-4 align-items-end">
        <div class="col-auto">
            <label class="form-label">Language</label>
            <select name="locale" class="form-select"
                    hx-get="/Index" hx-target="#songs-container" hx-trigger="change"
                    hx-include="[name='seed'],[name='avgLikes'],[name='viewMode'],[name='page']">
                <option value="en_US" selected="@(Model.Locale == "en_US")">English (USA)</option>
                <option value="de_DE" selected="@(Model.Locale == "de_DE")">German (Germany)</option>
                <option value="uk_UA" selected="@(Model.Locale == "uk_UA")">Ukrainian (Ukraine)</option>
            </select>
        </div>

        <div class="col-auto">
            <label class="form-label">Seed</label>
            <input type="number" name="seed" value="@Model.Seed" class="form-control"
                   hx-get="/Index" hx-trigger="change delay:400ms" hx-target="#songs-container"
                   hx-include="this, [name='locale'],[name='avgLikes'],[name='viewMode'],[name='page']" />
        </div>

        <div class="col-auto">
            <label class="form-label">Avg Likes</label>
            <input type="number" step="0.1" name="avgLikes" value="@Model.AvgLikes.ToString("F1")" min="0" max="10" class="form-control"
                   hx-get="/Index" hx-trigger="change delay:400ms" hx-target="#songs-container"
                   hx-include="this, [name='seed'],[name='locale'],[name='viewMode'],[name='page']" />
        </div>

        <div class="col-auto">
            <label class="form-label">View</label>
            <select name="viewMode" class="form-select"
                    hx-get="/Index" hx-target="#songs-container" hx-trigger="change"
                    hx-include="[name='seed'],[name='locale'],[name='avgLikes'],[name='page']">
                <option value="gallery" selected="@(Model.ViewMode == "gallery")">Gallery</option>
                <option value="table" selected="@(Model.ViewMode == "table")">Table</option>
            </select>
        </div>
    </div>

    <div id="songs-container">
        @if (Model.ViewMode == "table")
        {
            <partial name="_TableView" model="Model.Songs" />
        }
        else
        {
            <partial name="_GalleryView" model="Model.Songs" />
        }
    </div>

    <!-- Простая пагинация (можно улучшить) -->
    <nav aria-label="Pagination" class="mt-4">
        <ul class="pagination justify-content-center">
            <li class="page-item @(Model.Page == 0 ? "disabled" : "")">
                <a class="page-link" href="?page=@(Model.Page - 1)&seed=@Model.Seed&locale=@Model.Locale&avgLikes=@Model.AvgLikes&viewMode=@Model.ViewMode">Previous</a>
            </li>
            <li class="page-item disabled">
                <span class="page-link">Page @(Model.Page + 1)</span>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page=@(Model.Page + 1)&seed=@Model.Seed&locale=@Model.Locale&avgLikes=@Model.AvgLikes&viewMode=@Model.ViewMode">Next</a>
            </li>
        </ul>
    </nav>
</div>